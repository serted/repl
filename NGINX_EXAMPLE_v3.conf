# ===== /dev flat PHP app on kaib.net =====
# Put this inside your existing HTTPS server { ... } block

# Redirect /dev -> /dev/
location = /dev { return 302 /dev/; }

# Serve static under /dev/assets and /dev/img/cache as files, no PHP
location ^~ /dev/assets/ { root /var/www/kaib.net; try_files $uri =404; access_log off; }
location ^~ /dev/img/cache/ { root /var/www/kaib.net; try_files $uri =404; access_log off; }

# Main app
location ^~ /dev/ {
  root /var/www/kaib.net;
  index index.php index.html;
  try_files $uri $uri/ /dev/index.php?$query_string;
}

# PHP handler
location ~ ^/dev/.*\.php$ {
  root /var/www/kaib.net;
  include fastcgi_params;
  fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
  fastcgi_pass unix:/run/php/php8.3-fpm.sock; # use your PHP-FPM socket
  fastcgi_read_timeout 120s;
}
